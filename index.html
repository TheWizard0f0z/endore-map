<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa z Edytowalnymi Znacznikami</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body {
            	margin: 0;
	    	background-color: #2a2a2a;
        }
        #map {
            	height: 100vh;
            	background-color: #2a2a2a;
        }
        #menu {
		position: absolute;
            	top: 0;
            	left: 0;
            	width: 250px;
            	height: 100%;
            	background-color: #292929c0;
            	backdrop-filter: blur(6px);
            	color: rgb(150, 150, 150);
            	padding: 0 20px;
            	box-shadow: 5px 0 15px rgba(0, 0, 0, 0.7);
            	z-index: 1000;
            	font-family: 'Cinzel', serif;
            	transition: transform 0.3s ease-in-out;
            	overflow-y: auto;
            	overflow-x: hidden;
            	scrollbar-color: #8b5e3c #2a2a2a;
    	    	scrollbar-width: thin;
        }
        .menu-section {
            	margin-bottom: 20px;
            	padding-bottom: 10px;
            	border-bottom: 1px solid rgb(150, 150, 150);
        }
        .menu-logo {
    	    	display: block;
            	border-radius: 50%;
    	    	margin: auto;
	    	padding-top: 10px;
	}
	.logo-container {
		position: relative;
		display: inline-block;
        	margin-top: 70px;
        	margin-left: 10px;
	}
        .santa-hat {
		position: absolute;
		top: -60px; /* Dopasuj wartość w zależności od rozmiaru logo */
		left: 90%;
		transform: translateX(-50%);
		width: 100%; /* Dopasuj rozmiar czapki do logo */
		pointer-events: none; /* Zapobiega interakcjom z czapką */
	}
        .santa-orc {
		position: absolute;
		top: 107px; /* Dopasuj wartość w zależności od rozmiaru logo */
		right: -60%;
		transform: translateX(-50%);
		width: 40%; /* Dopasuj rozmiar czapki do logo */
		pointer-events: none; /* Zapobiega interakcjom z czapką */
	}
	.auth-buttons {
    		display: flex; /* Ustawia kontener na flexbox */
    		justify-content: center; /* Wyśrodkowanie przycisków */
    		gap: 10px; /* Odstęp między przyciskami */
	}
        #menu .login-btn, #menu .register-btn, #menu .logout-btn {
            	display: block;
		flex: none;
            	margin: 0 auto 10px;
            	padding: 10px 20px;
            	text-align: center;
            	background: #6b4226;
            	color: #f4e9c5;
            	border: 2px solid #c69c6d;
            	border-radius: 5px;
            	cursor: pointer;
            	text-decoration: none;
        }
        #menu .login-btn:hover, #menu .register-btn:hover {
            	background: #8b5e3c;
        }
        #menu h2 {
            	margin-top: 20px;
            	font-size: 1.2em;
            	text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
        }
        #menu ul {
            	list-style: none;
            	padding: 0;
            	margin: 10px 0;
        }
        #menu ul li {
            	color: rgb(215, 215, 215);
            	display: flex;
            	align-items: center;
            	margin: 5px 0;
        }
        #menu ul li input {
            	margin-right: 10px;
            	appearance: none;
            	width: 20px;
            	height: 20px;
            	border: 2px solid #c69c6d;
            	border-radius: 5px;
            	cursor: pointer;
            	position: relative;
        }
        #menu ul li input:checked {
            	background-color: #c69c6d;
        }
        #menu ul li input:checked::before {
            	content: '✓'; /* Znak wyboru */
    	    	color: #fff;
    	    	font-size: 16px;
    	    	position: absolute;
    	    	top: 50%;
    	    	left: 50%;
    	    	transform: translate(-50%, -50%);
        }
	#loadingOverlay {
    		display: none; /* Ukryj domyślnie */
    		position: fixed;
    		top: 0;
    		left: 0;
    		width: 100%;
    		height: 100%;
    		background-color: rgba(0, 0, 0, 0.5); /* Ciemne, półprzezroczyste tło */
    		z-index: 1100; /* Ustawienie na wierzchu */
	}
	#alertOverlay {
    		display: none; /* Ukryj domyślnie */
    		position: fixed;
    		top: 0;
    		left: 0;
    		width: 100%;
    		height: 100%;
    		background-color: rgba(0, 0, 0, 0.5); /* Ciemne, półprzezroczyste tło */
    		z-index: 1101; /* Ustawienie na wierzchu */
	}
	#loadingIndicator, #alertIndicator {
    		position: absolute;
    		top: 50%;
    		left: 50%;
    		transform: translate(-50%, -50%);
    		background-color: rgba(0, 0, 0, 0.4);
    		padding: 20px;
            	border: 5px solid #c69c6d;
            	box-shadow: 0 0 15px #000, 0 0 25px #6b4226;
    		border-radius: 15px;
    		color: #f4e9c5;
            	font-family: 'Cinzel', serif;
            	font-size: 20px;
    		text-align: center;
	}
        #dialog {
            	position: absolute;
            	top: 50%;
            	left: 50%;
            	transform: translate(-50%, -50%);
            	background: rgba(0, 0, 0, 0.4);
            	padding: 20px;
            	border: 5px solid #c69c6d;
            	box-shadow: 0 0 15px #000, 0 0 25px #6b4226;
            	border-radius: 15px;
            	color: #f4e9c5;
            	display: none;
            	z-index: 1000;
            	font-family: 'Cinzel', serif;
        }
        #dialog h3 {
            	color: #f4e9c5;
            	margin-bottom: 15px;
            	text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
            	font-size: 1.5em;
        }
        #dialog input, #dialog select {
            	display: block;
            	margin: 10px 0;
            	width: 100%;
    	    	width: -moz-available;          /* WebKit-based browsers will ignore this. */
    	    	width: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */
    	    	width: fill-available;
            	padding: 8px;
            	border: 2px solid #c69c6d;
            	background-color: #f4e9c5;
            	color: #3e2723;
            	border-radius: 5px;
            	outline: none;
            	font-family: 'Cinzel', serif;
            	box-shadow: inset 0 0 5px #000;
        }
        #dialog button {
            	margin-top: 10px;
            	padding: 8px 12px;
            	background-color: #6b4226;
            	border: 1px solid rgba(128, 64, 0, 0.9);
            	color: #f4e9c5;
            	font-family: 'Cinzel', serif;
            	border-radius: 5px;
            	cursor: pointer;
            	box-shadow: 0 0 10px #000, 0 0 15px #6b4226;
        }
        #dialog button:hover {
            	background-color: #8b5e3c;
            	box-shadow: 0 0 20px #000, 0 0 25px #8b5e3c;
        }
        #deleteMarkerButton {
            	background: linear-gradient(145deg, rgba(128, 0, 0, 1) 0%, rgba(80, 0, 0, 1) 100%);
            	color: #6b4226;
        }
        #deleteMarkerButton:hover {
            	background: linear-gradient(145deg, rgba(150, 0, 0, 1) 0%, rgba(100, 0, 0, 1) 100%);
        }
        #overlay {
            	position: absolute;
            	top: 0;
            	left: 0;
            	width: 100%;
            	height: 100%;
            	background: rgba(0, 0, 0, 0.5);
            	display: none;
            	z-index: 999;
        }
	#cursor-coordinates {
            	background-color: rgba(0, 0, 0, 0.4);
            	border-radius: 5px;
            	padding: 10px;
    	    	font-size: 14px;
    	    	color: rgb(215, 215, 215);
    	    	margin: 10px 0;
    	    	text-align: center;
	}
    	#marker-section input, #registerForm input, #loginForm input {
    	    	width: 100%;
    	    	width: -moz-available;          /* WebKit-based browsers will ignore this. */
    	    	width: -webkit-fill-available;  /* Mozilla-based browsers will ignore this. */
    	    	width: fill-available;
    	    	margin: 5px 0;
    	    	padding: 8px;
    	    	border: 2px solid #c69c6d;
    	    	border-radius: 5px;
    	    	background-color: #f4e9c5;
    	    	color: #3e2723;
    	    	font-family: 'Cinzel', serif;
    	    	box-shadow: inset 0 0 5px #000;
	}
	#marker-section button {
    	    	width: 100%;
    	    	padding: 10px;
    	    	background-color: #6b4226;
    	    	border: 2px solid #c69c6d;
    	    	color: #f4e9c5;
    	    	border-radius: 5px;
    	    	cursor: pointer;
    	    	font-family: 'Cinzel', serif;
	}
	#marker-section button:hover {
    	    	background-color: #8b5e3c;
	}
    	.blinking-marker {
    	    	animation: blink 1s steps(2, start) 5; /* 5 cykli */
	}
	@keyframes blink {
    	    	to {
        		visibility: hidden;
		}
	}
    	.toggle-menu-button {
    	    	position: absolute;
    	    	top: 10px;
    	    	left: 291px;
    	    	z-index: 1001;
    	    	background-color: #6b4226;
    	    	color: #f4e9c5;
    	    	border: none;
    	    	padding: 10px 15px;
    	    	font-size: 18px;
    	    	cursor: pointer;
    	    	border-radius: 2px;
    	    	box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.7);
    	    	transition: left 0.3s;
	}
	.toggle-menu-button:hover {
    	    	background-color: #8b5e3c;
	}
	.leaflet-left {
    	    	left: 281px;
	    	top: 50px;
            	transition: left 0.3s;
	}
    	.leaflet-touch .leaflet-control-layers, .leaflet-touch .leaflet-bar {
    	    	border: none;
    	    	box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.7);
	}
    	.leaflet-touch .leaflet-bar a:first-child, .leaflet-touch .leaflet-bar a:last-child {
    	    	background-color: #6b4226;
    	    	color: #f4e9c5;
	}
    	.leaflet-touch .leaflet-bar a:first-child:hover, .leaflet-touch .leaflet-bar a:last-child:hover {
		background-color: #8b5e3c;
	}
	.select2-container .select2-selection--single {
	    	height: 36px;
	    	line-height: 38px;
            	background-color: #f4e9c5;
            	box-shadow: inset 0 0 5px #000;
            	border: 2px solid #c69c6d;
            	border-radius: 5px;
	}
	.select2-container--default .select2-selection--single .select2-selection__rendered {
	    	color: #404040;
	    	font-family: 'Cinzel', serif;
            	font-size: 13px;
		line-height: 32px;
	}
    	.select2-container--default .select2-selection--single .select2-selection__arrow {
        	top: 5px;
    	}
    	input::placeholder {
        	color: rgb(150, 150, 150);
	}
    	.select2-dropdown {
    		background-color: #f4e9c5; /* Tło listy */
    		box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5); /* Cień */
    		color: #404040; /* Kolor tekstu */
            	overflow-y: auto;
            	overflow-x: hidden;
            	scrollbar-color: #8b5e3c #2a2a2a;
    	    	scrollbar-width: thin;
	}
        .select2-container--default .select2-results > .select2-results__options {
    		overflow-y: visible;
	}
    	.select2-results__option {
    		height: 30px;
    		padding: 0; /* Wewnętrzne marginesy */
            	font-size: 13px;
            	overflow-y: visible;
	}
    	.select2-results__option:hover {
    		background-color: #928B76 !important; /* Kolor tła przy najechaniu */
	}
    	.password-container {
    		position: relative;
    		display: inline-block;
        	width: -webkit-fill-available;
	}
	#togglePasswordVisibilityRegister, #togglePasswordVisibilityLogin {
    		position: absolute;
    		right: 10px;
    		top: 50%;
    		transform: translateY(-50%);
    		background: transparent;
    		border: none;
    		cursor: pointer;
	}
	#togglePasswordVisibilityRegister i, #togglePasswordVisibilityLogin i {
    		font-size: 20px;
	}
        
    </style>
</head>
<body>
	<div id="loadingOverlay">
		<div id="loadingIndicator"">Ładowanie...</div>
	</div>
	<div id="alertOverlay">
		<div id="alertIndicator"">Alert...</div>
	</div>
	<div id="menu">
		<div class="menu-section">
			<a href="https://wiki.endore.pl" target="_blank" class="logo-container">
        			<img src="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/media/wikilogofinal.gif" alt="Logo" class="menu-logo">
				<img src="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/media/santahat.png" alt="Santa Hat" class="santa-hat">
                    		<img src="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/media/santaorc.png" alt="Santa Orc" class="santa-orc">
			</a>
        	</div>
        	<div class="menu-section">
        		<form id="registerForm">
    				<input type="text" name="username" placeholder="Username" required />
                    		<div class="password-container">
    					<input type="password" name="password" placeholder="Password" required id="passwordFieldRegister"/>
                    			<button type="button" id="togglePasswordVisibilityRegister">
            					<i id="eyeIconRegister" class="fa fa-eye-slash"></i> <!-- Ikona oka -->
        				</button>
                    		</div>
    				<button type="submit" class="register-btn">Register</button>
			</form>
            		<form id="loginForm">
    				<input type="text" name="username" placeholder="Username" required />
                    		<div class="password-container">
    					<input type="password" name="password" placeholder="Password" required id="passwordFieldLogin"/>
    					<button type="button" id="togglePasswordVisibilityLogin">
            					<i id="eyeIconLogin" class="fa fa-eye-slash"></i> <!-- Ikona oka -->
        				</button>
                    		</div>
                    		<button type="submit" class="login-btn">Login</button>
			</form>
            		<button id="logoutButton" class="logout-btn" style="display: none;">Logout</button>
        	</div>
        	<div class="menu-section">
			<label>
    				<input type="checkbox" id="toggleDefaultMarkersButton" checked />
    				Pokaż podstawowe znaczniki
			</label>
        		<ul>
            			<li><input type="checkbox" id="showDefault" checked /> Domyślny</li>
            			<li><input type="checkbox" id="showMiasto" checked /> Miasta</li>
				<li><input type="checkbox" id="showZamek" checked /> Wieże/Zamki</li>
				<li><input type="checkbox" id="showArena" checked /> Areny</li>
				<li><input type="checkbox" id="showLoch" checked /> Lochy</li>
				<li><input type="checkbox" id="showCmentarz" checked /> Cmentarne</li>
				<li><input type="checkbox" id="showMob" checked /> Niebezpieczne lokacje</li>
				<li><input type="checkbox" id="showPotwor" checked /> Potwory</li>
                		<li><input type="checkbox" id="showZwierze" checked /> Zwierzęta</li>
				<li><input type="checkbox" id="showSkarb" checked /> Skarby</li>
                		<li><input type="checkbox" id="showMost" checked /> Mosty/Kładki</li>
                		<li><input type="checkbox" id="showWodne" checked /> Rzeki/Jeziora</li>
				<li><input type="checkbox" id="showWyspa" checked /> Wyspy</li>
				<li><input type="checkbox" id="showStatek" checked /> Statki/Łodzie</li>
				<li><input type="checkbox" id="showGora" checked /> Góry/Wzgórza</li>
				<li><input type="checkbox" id="showLas" checked /> Lasy</li>
				<li><input type="checkbox" id="showBagno" checked /> Bagna/Mokradła</li>
        		</ul>
			<label>
        			<input type="checkbox" id="toggleMarkerTooltips" />
        			Pokaż dymki znaczników
    			</label>
        	</div>
     		<div class="menu-section" id="coordinates-section">
    			<p id="cursor-coordinates">Współrzędne: (0, 0)</p>
            		<label>
        			<input type="checkbox" id="showRawCoordinates" />
        			Pokaż surowe współrzędne
	    		</label>
		</div>
        	<div class="menu-section" id="marker-section">
        		<label for="lng-input">Długość geograficzna:</label>
    			<input type="number" id="lng-input" step="0.01" placeholder="Np. 20.00">
    			<label for="lat-input">Szerokość geograficzna:</label>
    			<input type="number" id="lat-input" step="0.01" placeholder="Np. 50.00">
    			<button id="add-temp-marker">Idź do</button>
		</div>   
    	</div>
    	<button id="toggle-menu-button" class="toggle-menu-button">☰</button>
    	<div id="overlay"></div>
    	<div id="dialog">
        	<h3>Dodaj lub edytuj znacznik</h3>
        	<label for="markerTitle">Nazwa znacznika:</label>
        	<input type="text" id="markerTitle" placeholder="Wprowadź nazwę">
        	<label for="markerIcon">Wybierz rodzaj ikony:</label>
        	<select id="groupSelect" style="width: 100%;">
        		<option value="Default">Domyślne</option>
            		<!-- <option value="Miasto">Miasta</option> -->
			<option value="Zamek">Wieże/Zamki</option>
            		<option value="Arena">Areny</option>
            		<option value="Loch">Lochy</option>
			<option value="Cmentarz">Cmentarne</option>
            		<option value="Mob">Niebezpieczne lokacje</option>
            		<option value="Potwor">Potwory</option>
            		<option value="Zwierze">Zwierzęta</option>
            		<option value="Skarb">Skarby</option>
			<option value="Most">Mosty/Kładki</option>
			<option value="Wodne">Rzeki/Jeziora</option>
			<option value="Wyspa">Wyspy</option>
			<option value="Statek">Statki/Łodzie</option>
			<option value="Gora">Góry/Wzgórza</option>
			<option value="Las">Lasy</option>
			<option value="Bagno">Bagna/Mokradła</option>
        	</select>
        
        	<select id="markerIconDefault" class="marker-group" style="width: 100%; display: block;">
    			<option value="default" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default.png">Domyślna</option>
			<option value="default2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default2.png">Domyślna</option>
			<option value="default3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default3.png">Domyślna</option>
			<option value="default4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default4.png">Domyślna</option>
			<option value="default5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default5.png">Domyślna</option>
        	</select>
		
        	<select id="markerIconMiasto" class="marker-group" style="width: 100%; display: none;">
    			<option value="miasto1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto1.png">Miasto</option>
    			<option value="miasto2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto2.png">Miasto</option>
			<option value="miasto3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto3.png">Miasto</option>
    			<option value="miasto4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto4.png">Miasto</option>
			<option value="miasto5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto5.png">Miasto</option>
			<option value="miasto6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/amonsul.png">Amon Sûl</option>
			<option value="miasto7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/annuminas.png">Annúminas</option>
			<option value="miasto8" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/carndums.png">Carn Dûm</option>
			<option value="miasto9" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/emynberaid.png">Emyn Beraid (Białe Wieże)</option>
			<option value="miasto10" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/fornost.png">Fornost</option>
			<option value="miasto11" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/forochel.png">Osada w Forochel</option>
			<option value="miasto12" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/hobbiton.png">Hobbiton</option>
			<option value="miasto13" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/londdaer.png">Lond Daer</option>
			<option value="miasto14" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/mithlond.png">Mithlond (Szare Przystanie)</option>
			<option value="miasto15" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/zachodniabramamorii.png">Zachodnia brama Morii</option>
        	</select>

		<select id="markerIconZamek" class="marker-group" style="width: 100%; display: none;">
    			<option value="zamek1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek1.png">Wieża</option>
    			<option value="zamek2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek2.png">Wieża</option>
			<option value="zamek3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek3.png">Wieża</option>
    			<option value="zamek4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek4.png">Wieża</option>
			<option value="zamek5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek5.png">Wieża</option>
			<option value="zamek6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek6.png">Wieża</option>
			<option value="zamek7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek7.png">Wieża</option>

			<option value="zamek8" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek8.png">Zamek</option>
    			<option value="zamek9" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek9.png">Zamek</option>
			<option value="zamek10" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek10.png">Zamek</option>
    			<option value="zamek11" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek11.png">Zamek</option>
			<option value="zamek12" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek12.png">Zamek</option>
			<option value="zamek13" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek13.png">Zamek</option>
			<option value="zamek14" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek14.png">Zamek</option>
			<option value="zamek15" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek15.png">Zamek</option>
			<option value="zamek16" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek16.png">Zamek</option>

			<option value="zamek17" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek17.png">Mroczny zamek</option>
    			<option value="zamek18" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek18.png">Mroczny zamek</option>
			<option value="zamek19" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek19.png">Mroczny zamek</option>
    			<option value="zamek20" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek20.png">Mroczny zamek</option>
			<option value="zamek21" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek21.png">Mroczny zamek</option>
			<option value="zamek22" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek22.png">Mroczny zamek</option>
        	</select>
		
        	<select id="markerIconArena" class="marker-group" style="width: 100%; display: none;">
			<option value="arena1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena1.png">Arena</option>
			<option value="arena2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena2.png">Arena</option>
			<option value="arena3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena3.png">Arena</option>
			<option value="arena4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena4.png">Arena</option>
			<option value="arena5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena5.png">Arena</option>
			<option value="arena6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena6.png">Arena</option>
			<option value="arena7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena7.png">Arena</option>
        	</select>
		
        	<select id="markerIconLoch" class="marker-group" style="width: 100%; display: none;">
			<option value="loch1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch1.png">Loch</option>
			<option value="loch2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch2.png">Loch</option>
			<option value="loch3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch3.png">Loch</option>
			<option value="loch4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch4.png">Loch</option>
			<option value="loch5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch5.png">Loch</option>
			<option value="loch6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch6.png">Loch</option>
			<option value="loch7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch7.png">Loch</option>
        	</select>

		<select id="markerIconCmentarz" class="marker-group" style="width: 100%; display: none;">
			<option value="cmentarz1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz1.png">Nagrobek</option>
			<option value="cmentarz2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz2.png">Nagrobek</option>
			<option value="cmentarz3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz3.png">Nagrobek</option>
			<option value="cmentarz4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz4.png">Nagrobek</option>
			<option value="cmentarz5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz5.png">Nagrobek</option>
			<option value="cmentarz6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz6.png">Nagrobek</option>
			
			<option value="cmentarz7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz7.png">Nagrobki</option>
			<option value="cmentarz8" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz8.png">Nagrobki</option>
			<option value="cmentarz9" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz9.png">Nagrobki</option>

			<option value="cmentarz10" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz10.png">Kapliczka</option>
			<option value="cmentarz11" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz11.png">Kapliczka</option>
			<option value="cmentarz12" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz12.png">Kapliczka</option>
        	</select>
		
        	<select id="markerIconMob" class="marker-group" style="width: 100%; display: none;">
			<option value="mob1nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB1NM.png">Niebezpieczna lokacja poz.1</option>
			<option value="mob2nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB2NM.png">Niebezpieczna lokacja poz.2</option>
			<option value="mob3nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB3NM.png">Niebezpieczna lokacja poz.3</option>
			<option value="mob4nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB4NM.png">Niebezpieczna lokacja poz.4</option>
			<option value="mob5nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB5NM.png">Niebezpieczna lokacja poz.5</option>
			<option value="mob6nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB6NM.png">Niebezpieczna lokacja poz.6</option>
			<option value="mob7nm" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB7NM.png">Niebezpieczna lokacja poz.7</option>

			<option value="mob1ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB1PS.png">Niebezpieczna lokacja poz.1</option>
			<option value="mob2ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB2PS.png">Niebezpieczna lokacja poz.2</option>
			<option value="mob3ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB3PS.png">Niebezpieczna lokacja poz.3</option>
			<option value="mob4ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB4PS.png">Niebezpieczna lokacja poz.4</option>
			<option value="mob5ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB5PS.png">Niebezpieczna lokacja poz.5</option>
			<option value="mob6ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB6PS.png">Niebezpieczna lokacja poz.6</option>
			<option value="mob7ps" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB7PS.png">Niebezpieczna lokacja poz.7</option>

			<option value="mob1sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB1SA.png">Niebezpieczna lokacja poz.1</option>
			<option value="mob2sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB2SA.png">Niebezpieczna lokacja poz.2</option>
			<option value="mob3sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB3SA.png">Niebezpieczna lokacja poz.3</option>
			<option value="mob4sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB4SA.png">Niebezpieczna lokacja poz.4</option>
			<option value="mob5sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB5SA.png">Niebezpieczna lokacja poz.5</option>
			<option value="mob6sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB6SA.png">Niebezpieczna lokacja poz.6</option>
			<option value="mob7sa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB7SA.png">Niebezpieczna lokacja poz.7</option>

			<option value="mob1sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB1SP.png">Niebezpieczna lokacja poz.1</option>
			<option value="mob2sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB2SP.png">Niebezpieczna lokacja poz.2</option>
			<option value="mob3sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB3SP.png">Niebezpieczna lokacja poz.3</option>
			<option value="mob4sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB4SP.png">Niebezpieczna lokacja poz.4</option>
			<option value="mob5sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB5SP.png">Niebezpieczna lokacja poz.5</option>
			<option value="mob6sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB6SP.png">Niebezpieczna lokacja poz.6</option>
			<option value="mob7sp" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB7SP.png">Niebezpieczna lokacja poz.7</option>
        	</select>
		
        	<select id="markerIconPotwor" class="marker-group" style="width: 100%; display: none;">
			<option value="potworcyklop" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/cyklop.png">Cyklop</option>
			<option value="potworduch" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/duch.png">Duch</option>
			<option value="potworettin" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ettin.png">Ettin</option>
			<option value="potworharpia" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/harpia.png">Harpia</option>
			<option value="potworlicz" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/licz.png">Licz</option>
			<option value="potwormumia" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/mumia.png">Mumia</option>
			<option value="potworogr" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ogr.png">Ogr</option>
			<option value="potworork" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ork.png">Ork</option>
			<option value="potwororkkapitan" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/orkkapitan.png">Uruk-hai</option>
			<option value="potworsmok1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok1.png">Smok</option>
			<option value="potworsmok2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok2.png">Smok</option>
			<option value="potworsmok3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok3.png">Smok</option>
			<option value="potworsmok4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok4.png">Smok</option>
			<option value="potworwarg" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/warg.png">Warg</option>
			<option value="potworszkielet" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/szkielet.png">Szkielet</option>
			<option value="potwortroll" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/troll.png">Troll</option>
			<option value="potworzombi" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/zombi.png">Zombi</option>
        	</select>
        
        	<select id="markerIconZwierze" class="marker-group" style="width: 100%; display: none;">
			<option value="zwierzelama1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/lama1.png">Lama</option>
			<option value="zwierzekon1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon1.png">Koń</option>
			<option value="zwierzekon2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon2.png">Koń</option>
			<option value="zwierzekon3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon3.png">Koń</option>
			<option value="zwierzekon4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon4.png">Koń</option>
			<option value="zwierzekon5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon5.png">Koń</option>
			<option value="zwierzekon6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon6.png">Nieumarły Koń</option>
			<option value="zwierzegrizzly" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/grizzly.png">Grizzly</option>
			<option value="zwierzeniedzwiedzpolarny" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/niedzwiedzpolarny.png">Niedźwiedź polarny</option>
			<option value="zwierzepajak1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak1.png">Pająk</option>
			<option value="zwierzepajak3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak3.png">Pająk</option>
			<option value="zwierzepajak4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak4.png">Pająk</option>
			<option value="zwierzeskorpion" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/skorpion.png">Skorpion</option>
			<option value="zwierzewaz1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz1.png">Wąż</option>
			<option value="zwierzewaz2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz2.png">Wąż</option>
			<option value="zwierzewaz3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz3.png">Wąż</option>
			<option value="zwierzewaz4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz4.png">Wąż</option>
			<option value="zwierzewilk1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk1.png">Wilk</option>
			<option value="zwierzewilk2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk2.png">Wilk</option>
			<option value="zwierzewilk3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk3.png">Wilk</option>
        	</select>
		
        	<select id="markerIconSkarb" class="marker-group" style="width: 100%; display: none;">
			<option value="skarb1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb1.png">Skarb poz.1</option>
			<option value="skarb2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb2.png">Skarb poz.2</option>
			<option value="skarb3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb3.png">Skarb poz.3</option>
			<option value="skarb4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb4.png">Skarb poz.4</option>
			<option value="skarb5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb5.png">Skarb poz.5</option>
			<option value="skarb6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb6.png">Skarb poz.6</option>
			<option value="skarb7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb7.png">Skarb poz.7</option>
			<option value="skarb8" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb8.png">Skarb poz.8</option>
        	</select>

		<select id="markerIconMost" class="marker-group" style="width: 100%; display: none;">
			<option value="most1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most1.png">Most kamienny</option>
			<option value="most2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most2.png">Most kamienny</option>
			<option value="most3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most3.png">Most drewniany</option>
			<option value="most4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most4.png">Most drewniany</option>
        	</select>

		<select id="markerIconWodne" class="marker-group" style="width: 100%; display: none;">
			<option value="wodne1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka1.png">Rzeka</option>
			<option value="wodne2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka2.png">Rzeka</option>
			<option value="wodne3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka3.png">Rzeka</option>
			<option value="wodne4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka4.png">Rzeka</option>

			<option value="wodne1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro1.png">Jezioro</option>
			<option value="wodne2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro2.png">Jezioro</option>
			<option value="wodne3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro3.png">Jezioro</option>
			<option value="wodne4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro4.png">Jezioro</option>
		</select>

		<select id="markerIconWyspa" class="marker-group" style="width: 100%; display: none;">
			<option value="wyspa1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa1.png">Wyspa</option>
			<option value="wyspa2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa2.png">Wyspa</option>
			<option value="wyspa3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa3.png">Wyspa</option>
			<option value="wyspa4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa4.png">Wyspa</option>
		</select>

		<select id="markerIconStatek" class="marker-group" style="width: 100%; display: none;">
			<option value="statek1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek1.png">Statek</option>
			<option value="statek2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek2.png">Statek</option>
			<option value="statek3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek3.png">Wrak</option>
			<option value="statek4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek4.png">Łódka</option>
			<option value="statek5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek5.png">Łódka</option>
		</select>

		<select id="markerIconGora" class="marker-group" style="width: 100%; display: none;">
			<option value="gora1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora1.png">Góra</option>
			<option value="gora2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora2.png">Góra</option>
			<option value="gora3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora3.png">Góra</option>
			<option value="gora4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora4.png">Góra</option>
			<option value="gora5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora5.png">Góra</option>
			<option value="gora6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora6.png">Góra</option>
			<option value="gora7" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora7.png">Góra</option>
			<option value="gora8" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora8.png">Góra</option>
			<option value="gora9" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora9.png">Góra</option>
			<option value="gora10" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora10.png">Góra</option>
			<option value="gora11" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora11.png">Góra</option>
		</select>

		<select id="markerIconLas" class="marker-group" style="width: 100%; display: none;">
			<option value="las1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las1.png">Las</option>
			<option value="las2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las2.png">Las</option>
			<option value="las3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las3.png">Las</option>
			<option value="las4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las4.png">Las</option>
			<option value="las5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las5.png">Las</option>
			<option value="las6" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las6.png">Las</option>
		</select>

		<select id="markerIconBagno" class="marker-group" style="width: 100%; display: none;">
			<option value="bagno1" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno1.png">Bagno</option>
			<option value="bagno2" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno2.png">Bagno</option>
			<option value="bagno3" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno3.png">Bagno</option>
			<option value="bagno4" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno4.png">Bagno</option>
			<option value="bagno5" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno5.png">Mokradło</option>
		</select>
		
        	<select id="markerIconInne" class="marker-group" style="width: 100%; display: none;">
			<option value="wyspa" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/inne/wyspa.png">Wyspa</option>
			<option value="lodka" data-icon="https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/inne/lodka.png">Łódka</option>
		</select>
        
        	<button id="addMarkerButton">Dodaj znacznik</button>
        	<button id="deleteMarkerButton" style="display: none;">Usuń znacznik</button>
    	</div>
	<div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        const map = L.map('map', { minZoom: 1, maxZoom: 4 }).setView([0, 0], 1);
        const imageBounds = [[-85, -256], [85, 256]];
        L.imageOverlay('https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/mapa.jpg', imageBounds).addTo(map);
        map.fitBounds(imageBounds);

        const markers = [];
        const icons = {
            default: L.icon({
                iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default.png',
                iconSize: [31, 31],
                iconAnchor: [15, 31],
                popupAnchor: [0, -31],
                shadowUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/robocze/default-shadow.png',
                shadowSize: [31, 31],
    		shadowAnchor: [11, 31]
            }),
	    default2: L.icon({
                iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default2.png',
                iconSize: [31, 31],
                iconAnchor: [15, 31],
                popupAnchor: [0, -31],
                shadowUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/robocze/default-shadow.png',
                shadowSize: [31, 31],
    		shadowAnchor: [11, 31]
            }),
	    default3: L.icon({
                iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default3.png',
                iconSize: [31, 31],
                iconAnchor: [15, 31],
                popupAnchor: [0, -31],
                shadowUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/robocze/default-shadow.png',
                shadowSize: [31, 31],
    		shadowAnchor: [11, 31]
            }),
	    default4: L.icon({
                iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default4.png',
                iconSize: [31, 31],
                iconAnchor: [15, 31],
                popupAnchor: [0, -31],
                shadowUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/robocze/default-shadow.png',
                shadowSize: [31, 31],
    		shadowAnchor: [11, 31]
            }),
	    default5: L.icon({
                iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/default/default5.png',
                iconSize: [31, 31],
                iconAnchor: [15, 31],
                popupAnchor: [0, -31],
                shadowUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/robocze/default-shadow.png',
                shadowSize: [31, 31],
    		shadowAnchor: [11, 31]
            }),
		
            	miasto1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
            	miasto2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
            	miasto3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
            	miasto4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/miasto5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/amonsul.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/annuminas.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/carndums.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto9: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/emynberaid.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto10: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/fornost.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto11: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/forochel.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto12: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/hobbiton.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto13: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/londdaer.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		miasto14: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/miasta/zachodniabramamorii.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		zamek1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		zamek8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek8.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek9: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek9.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek10: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek10.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek11: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek11.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek12: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek12.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek13: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek13.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek14: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek14.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek15: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek15.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek16: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek16.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		zamek17: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek17.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek18: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek18.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek19: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek19.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek20: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek20.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek21: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek21.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zamek22: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zamki/zamek22.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

	    	arena1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		arena7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/arena/arena7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		loch1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		loch7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lochy/loch7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		cmentarz1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		cmentarz7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz8.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz9: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz9.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		cmentarz10: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz10.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz11: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz11.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		cmentarz12: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/cmentarz/cmentarz12.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		mob1nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB1NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob2nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB2NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob3nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB3NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob4nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB4NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob5nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB5NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob6nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB6NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob7nm: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob1/MOB7NM.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		mob1ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB1PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob2ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB2PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob3ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB3PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob4ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB4PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob5ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB5PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob6ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB6PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob7ps: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob2/MOB7PS.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		mob1sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB1SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob2sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB2SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob3sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB3SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob4sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB4SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob5sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB5SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob6sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB6SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob7sa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob3/MOB7SA.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		mob1sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB1SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob2sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB2SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob3sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB3SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob4sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB4SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob5sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB5SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob6sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB6SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		mob7sp: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mob4/MOB7SP.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		potworcyklop: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/cyklop.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworduch: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/duch.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworettin: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ettin.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworharpia: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/harpia.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworlicz: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/licz.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potwormumia: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/mumia.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworogr: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ogr.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworork: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/ork.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potwororkkapitan: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/orkkapitan.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworsmok1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworsmok2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworsmok3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworsmok4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/smok4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworwarg: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/warg.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworszkielet: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/szkielet.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potwortroll: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/troll.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		potworzombi: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/potwory/zombi.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		zwierzelama1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/lama1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzekon1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzekon2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzekon3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzekon4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzekon5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/kon5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzegrizzly: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/grizzly.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzeniedzwiedzpolarny: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/niedzwiedzpolarny.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzepajak1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzepajak3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzepajak4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/pajak4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzeskorpion: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/skorpion.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewaz1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewaz2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewaz3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewaz4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/waz4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewilk1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewilk2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		zwierzewilk3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/zwierzeta/wilk3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		skarb1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		skarb8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/skarby/skarb8.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		most1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		most2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		most3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		most4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/mosty/most4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		wodne1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/rzeka4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		wodne5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wodne8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wodne/jezioro4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		wyspa1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wyspa2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wyspa3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		wyspa4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/wyspy/wyspa4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		statek1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		statek2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		statek3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		statek4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		statek5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/statki/statek5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		
		gora1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora7: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora7.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora8: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora8.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora9: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora9.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora10: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora10.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		gora11: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/gory/gora11.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),

		las1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		las2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		las3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		las4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		las5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		las6: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/lasy/las6.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		
		bagno1: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno1.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		bagno2: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno2.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		bagno3: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno3.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		bagno4: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno4.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		bagno5: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/bagna/bagno5.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		
		wyspa: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/inne/wyspa.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] }),
		lodka: L.icon({ iconUrl: 'https://raw.githubusercontent.com/TheWizard0f0z/endore-map/refs/heads/main/ikony/inne/lodka.png', iconSize: [31, 31], iconAnchor: [15, 31], popupAnchor: [0, -31] })
        };

	    const dialog = document.getElementById('dialog');
	    const overlay = document.getElementById('overlay');
	    const markerTitleInput = document.getElementById('markerTitle');
	    const markerIconSelect = document.getElementById('markerIcon');
	    const addMarkerButton = document.getElementById('addMarkerButton');
	    const deleteMarkerButton = document.getElementById('deleteMarkerButton');

	    const showDefaultCheckbox = document.getElementById('showDefault');
	    const showMiastoCheckbox = document.getElementById('showMiasto');
	    const showZamekCheckbox = document.getElementById('showZamek');
	    const showArenaCheckbox = document.getElementById('showArena');
	    const showLochCheckbox = document.getElementById('showLoch');
	    const showCmentarzCheckbox = document.getElementById('showCmentarz');
	    const showMobCheckbox = document.getElementById('showMob');
	    const showPotworCheckbox = document.getElementById('showPotwor');
            const showZwierzeCheckbox = document.getElementById('showZwierze');
	    const showSkarbCheckbox = document.getElementById('showSkarb');
	    const showMostCheckbox = document.getElementById('showMost');
	    const showWodneCheckbox = document.getElementById('showWodne');
	    const showWyspaCheckbox = document.getElementById('showWyspa');
	    const showStatekCheckbox = document.getElementById('showStatek');
	    const showGoraCheckbox = document.getElementById('showGora');
	    const showLasCheckbox = document.getElementById('showLas');
	    const showBagnoCheckbox = document.getElementById('showBagno');
	    
        let pendingLatLng = null;

// SELECT2
    // Funkcja do formatowania opcji w Select2, w tym wyświetlanie ikon
$(document).ready(function () {
    // Funkcja do formatowania opcji w Select2, w tym wyświetlanie ikon
    function formatIcon(option) {
        if (!option.id) {
            return option.text; // Jeśli nie ma ID, zwraca tylko tekst
        }
        const iconUrl = $(option.element).data('icon'); // Pobranie URL ikony
        return $('<span>')
            .append($('<img>', {
                src: iconUrl,
                css: {
                    width: '30px', // Ustalamy rozmiar ikony
                    height: '30px',
                    marginRight: '8px',
                    verticalAlign: 'middle',
                    paddingBottom: '2px'
                }
            }))
            .append(option.text);
    }

    // Inicjalizacja Select2 dla każdej grupy markerów
    $('.marker-group').each(function () {
        $(this).select2({
            templateResult: formatIcon,
            templateSelection: formatIcon,
            minimumResultsForSearch: -1, // Ukrycie pola wyszukiwania
            dropdownCssClass: 'custom-dropdown'
        });
    });

    // Obsługa zmiany opcji w #groupSelect
    document.getElementById('groupSelect').addEventListener('change', function () {
        const selectedGroup = this.value; // Pobierz wybraną wartość grupy

        // Ukryj wszystkie grupy markerów i ich kontenery Select2
        document.querySelectorAll('.marker-group').forEach(select => {
            select.style.display = 'none'; // Ukryj <select>
            select.disabled = true; // Dezaktywuj <select>

            // Ukryj kontener Select2 powiązany z <select>
            const select2Container = $(select).next('.select2-container');
            select2Container.hide(); // Ukryj kontener Select2
        });

        // Pokaż i aktywuj odpowiednią grupę
        const activeSelect = document.getElementById(`markerIcon${selectedGroup}`);
        if (activeSelect) {
            activeSelect.style.display = 'block'; // Pokaż aktywny <select>
            activeSelect.disabled = false; // Aktywuj <select>

            // Zainicjalizuj Select2 dla aktywnego selecta (jeśli jeszcze nie istnieje)
            if (!$(activeSelect).data('select2')) {
                $(activeSelect).select2({
                    templateResult: formatIcon,
                    templateSelection: formatIcon,
                    minimumResultsForSearch: -1, // Ukrycie pola wyszukiwania
                    dropdownCssClass: 'custom-dropdown'
                });
            }

            // Pokaż kontener Select2 dla aktywnego selecta
            const activeSelect2Container = $(activeSelect).next('.select2-container');
            activeSelect2Container.show(); // Pokaż kontener Select2
        }
    });

    // Inicjalizacja dla `defaultSelect`
    const defaultSelect = document.getElementById('markerIconDefault'); // Zakładamy, że ID to markerIconDefault
    if (defaultSelect) {
        $(defaultSelect).select2({
            templateResult: formatIcon,
            templateSelection: formatIcon,
            minimumResultsForSearch: -1, // Ukrycie pola wyszukiwania
            dropdownCssClass: 'custom-dropdown'
        });
    }
});

// Funkcja otwierająca dialog
function openDialog(lat, lng, markerToEdit = null) {
    // Sprawdzenie, czy użytkownik jest zalogowany
    const token = localStorage.getItem('token');
    if (!token) {
        // alert('Musisz być zalogowany, aby dodać lub edytować znacznik.');
	// Pokaż komunikat w overlay
	showAlert('Musisz być zalogowany, aby dodać lub edytować znacznik.');

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
        return;  // Zatrzymanie dalszej obsługi otwarcia dialogu
    }
	
    pendingLatLng = { lat, lng, markerToEdit };

    // Logowanie informacji o markerToEdit
    console.log('markerToEdit:', markerToEdit);
    if (markerToEdit) {
        console.log('Tytuł znacznika:', markerToEdit.title || 'Brak tytułu');
        console.log('Grupa znacznika:', markerToEdit.group || 'Brak grupy');
        console.log('Nazwa ikony znacznika:', markerToEdit.iconType || 'Brak nazwy ikony');
    } else {
        console.log('Tworzenie nowego znacznika.');
    }

    // Resetuj wszystkie pola do wartości domyślnych
    markerTitleInput.value = ''; // Resetuj nazwę znacznika
    document.getElementById('groupSelect').value = 'Default'; // Resetuj grupę

    document.querySelectorAll('.marker-group').forEach(select => {
        select.style.display = 'none'; // Ukrycie elementów <select>
        select.disabled = true;
        const select2Container = $(select).next('.select2-container');
        select2Container.hide(); // Ukrycie kontenera Select2
    });

    // Pokaż okienko `.marker-group` dla wartości domyślnej
    const defaultSelect = document.getElementById('markerIconDefault'); // Zakładamy, że ID to markerIconDefault
    if (defaultSelect) {
        defaultSelect.value = 'default'; // Ustaw wartość domyślną
        defaultSelect.style.display = 'block'; // Pokaż aktywny <select>
        defaultSelect.disabled = false;

        // Jeśli Select2 już istnieje, odśwież widok wybranej opcji
        if ($(defaultSelect).data('select2')) {
            $(defaultSelect).val('default').trigger('change.select2'); // Ustaw wartość i odśwież
        } else {
            // Inicjalizacja Select2 z domyślną funkcją formatowania
            $(defaultSelect).select2({
                templateResult: formatIcon,
                templateSelection: formatIcon,
                minimumResultsForSearch: -1,
                dropdownCssClass: 'custom-dropdown'
            });
            $(defaultSelect).val('default').trigger('change.select2');
        }

        // Pokaż kontener Select2
        const defaultSelect2Container = $(defaultSelect).next('.select2-container');
        defaultSelect2Container.show();
    }

    // Ustawianie znaczników dla edycji
    if (markerToEdit) {
    // 🟢 Wypełnij pole tytułu
    markerTitleInput.value = markerToEdit.title; 

    // 🟢 Wypełnij pole grupy
    document.getElementById('groupSelect').value = markerToEdit.group; 

    // 🟢 Zresetuj wszystkie selecty związane z typem ikony
    document.querySelectorAll('.marker-group').forEach(select => {
        select.style.display = 'none'; 
        select.disabled = true;
        const select2Container = $(select).next('.select2-container');
        select2Container.hide(); 
    });

    // 🟢 Znajdź właściwy select dla iconType
    const activeSelect = document.getElementById(`markerIcon${markerToEdit.group}`); // 🟢 Używamy markerToEdit.group zamiast iconType
    if (activeSelect) {
        activeSelect.value = markerToEdit.iconType; // 🟢 Ustaw odpowiednią wartość iconType
        activeSelect.style.display = 'block';
        activeSelect.disabled = false;

        if ($(activeSelect).data('select2')) {
            $(activeSelect).val(markerToEdit.iconType).trigger('change.select2'); 
        } else {
            $(activeSelect).select2({
                templateResult: formatIcon,
                templateSelection: formatIcon,
                minimumResultsForSearch: -1,
                dropdownCssClass: 'custom-dropdown'
            });
            $(activeSelect).val(markerToEdit.iconType).trigger('change.select2'); 
        }

        const activeSelect2Container = $(activeSelect).next('.select2-container');
        activeSelect2Container.show();
    }
}


    addMarkerButton.textContent = markerToEdit ? "Zapisz zmiany" : "Dodaj znacznik";
    deleteMarkerButton.style.display = markerToEdit ? 'block' : 'none';

    dialog.style.display = 'block';
    overlay.style.display = 'block';
}




// CLOSE DIALOG
        function closeDialog() {
            dialog.style.display = 'none';
            overlay.style.display = 'none';
        }
        
        
// ADDORUPDATEMARKER
// Funkcja do dodawania lub aktualizacji znacznika (wykorzystuje loadMarkers())
async function addOrUpdateMarker() {
    const title = markerTitleInput.value.trim();
    const selectedGroup = document.getElementById('groupSelect').value;
    const markerIconSelect = document.getElementById(`markerIcon${selectedGroup}`);
    const iconType = markerIconSelect ? markerIconSelect.value : 'default';

    if (!title) {
        // alert('Proszę podać nazwę znacznika.');
	// Pokaż komunikat w overlay
	showAlert('Proszę podać nazwę znacznika.');

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
        return;
    }
    try {
        if (pendingLatLng.markerToEdit) {
            const markerData = markers.find(m => m._id === pendingLatLng.markerToEdit._id);
            if (markerData && markerData._id) {
                const updatedData = { title, group: selectedGroup, iconType, coordinates: markerData.coordinates };
                await updateMarkerOnServer(markerData._id, updatedData);
            }
        } else {
            const newMarkerData = {
                title,
                group: selectedGroup,
                iconType,
                coordinates: { lat: pendingLatLng.lat, lng: pendingLatLng.lng }
            };
            await addMarkerToServer(newMarkerData);
        }

        await loadMarkers();

	// Sprawdź, czy toggle dla domyślnych markerów jest zaznaczony
        const isDefaultMarkersVisible = document.getElementById('toggleDefaultMarkersButton').checked;

        if (isDefaultMarkersVisible) {
            addDefaultMarkers(); // Dodaj domyślne markery, jeśli toggle jest zaznaczony
        }

	// Sprawdź, czy toggle dla dymków markerów jest zaznaczony
        const isMarkerTooltipsVisible = document.getElementById('toggleMarkerTooltips').checked;

        if (isMarkerTooltipsVisible) {
    		toggleMarkerTooltips(true); // Otwórz tooltipy, jeśli toggle jest zaznaczony
	} else {
    		toggleMarkerTooltips(false); // Zamknij tooltipy, jeśli toggle nie jest zaznaczony
	}
    } catch (error) {
        console.error('❌ Błąd podczas dodawania lub aktualizowania znacznika:', error);
        // alert('Wystąpił błąd: ' + error.message);
	// Pokaż komunikat w overlay
	showAlert('Wystąpił błąd: ' + error.message);

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
    }

    closeDialog();
}


        async function removeMarker(markerToEdit) {
    		if (!markerToEdit || !markerToEdit._id) {
        		console.error("Nie można usunąć znacznika: brak danych.");
        		return;
    		}

    		const confirmation = confirm('Czy na pewno chcesz usunąć ten znacznik?');
    		if (!confirmation) {
        		return; // Użytkownik anulował usunięcie
    		}

    		try {
        		// Usunięcie znacznika na serwerze
        		await deleteMarkerFromServer(markerToEdit._id);
        
        		// Odświeżenie znaczników na mapie
        		await loadMarkers();

			// Sprawdź, czy toggle dla domyślnych markerów jest zaznaczony
        		const isDefaultMarkersVisible = document.getElementById('toggleDefaultMarkersButton').checked;

        		if (isDefaultMarkersVisible) {
            			addDefaultMarkers(); // Dodaj domyślne markery, jeśli toggle jest zaznaczony
        		}

			// Sprawdź, czy toggle dla dymków markerów jest zaznaczony
        		const isMarkerTooltipsVisible = document.getElementById('toggleMarkerTooltips').checked;

        		if (isMarkerTooltipsVisible) {
    				toggleMarkerTooltips(true); // Otwórz tooltipy, jeśli toggle jest zaznaczony
			} else {
    				toggleMarkerTooltips(false); // Zamknij tooltipy, jeśli toggle nie jest zaznaczony
			}

        		// Zamknięcie okna dialogowego
        		closeDialog();

        		console.log("Znacznik został pomyślnie usunięty.");
    		} catch (error) {
        		console.error("Błąd podczas usuwania znacznika:", error);
        		// alert('Nie udało się usunąć znacznika: ' + error.message);
			// Pokaż komunikat w overlay
			showAlert('Nie udało się usunąć znacznika: ' + error.message);

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
    		}
	}

        function toggleMarkers(type, isVisible) {
            markers.forEach(({ marker, iconType }) => {
                if (iconType.includes(type)) {
                    isVisible ? marker.addTo(map) : map.removeLayer(marker);
                }
            });
        }

        showDefaultCheckbox.addEventListener('change', (e) => {
            toggleMarkers('default', e.target.checked);
        });
        showMiastoCheckbox.addEventListener('change', (e) => {
            toggleMarkers('miasto', e.target.checked);
        });
	showZamekCheckbox.addEventListener('change', (e) => {
            toggleMarkers('zamek', e.target.checked);
        });
	showArenaCheckbox.addEventListener('change', (e) => {
            toggleMarkers('arena', e.target.checked);
        });
	showLochCheckbox.addEventListener('change', (e) => {
            toggleMarkers('loch', e.target.checked);
        });
	showCmentarzCheckbox.addEventListener('change', (e) => {
            toggleMarkers('cmentarz', e.target.checked);
        });
	showMobCheckbox.addEventListener('change', (e) => {
            toggleMarkers('mob', e.target.checked);
        });
	showPotworCheckbox.addEventListener('change', (e) => {
            toggleMarkers('potwor', e.target.checked);
        });
    	showZwierzeCheckbox.addEventListener('change', (e) => {
            toggleMarkers('zwierze', e.target.checked);
        });
	showSkarbCheckbox.addEventListener('change', (e) => {
            toggleMarkers('skarb', e.target.checked);
        });
        showMostCheckbox.addEventListener('change', (e) => {
            toggleMarkers('most', e.target.checked);
        });
	showWodneCheckbox.addEventListener('change', (e) => {
            toggleMarkers('wodne', e.target.checked);
        });
	showWyspaCheckbox.addEventListener('change', (e) => {
            toggleMarkers('wyspa', e.target.checked);
        });
	showStatekCheckbox.addEventListener('change', (e) => {
            toggleMarkers('statek', e.target.checked);
        });
	showGoraCheckbox.addEventListener('change', (e) => {
            toggleMarkers('gora', e.target.checked);
        });
	showLasCheckbox.addEventListener('change', (e) => {
            toggleMarkers('las', e.target.checked);
        });
	showBagnoCheckbox.addEventListener('change', (e) => {
            toggleMarkers('bagno', e.target.checked);
        });

        deleteMarkerButton.addEventListener('click', () => {
            if (pendingLatLng.markerToEdit) {
                removeMarker(pendingLatLng.markerToEdit);
            }
        });

	// Pobierz referencję do checkboxa
	const toggleMarkerTooltipsCheckbox = document.getElementById('toggleMarkerTooltips');

	// Funkcja do pokazywania lub ukrywania dymków
	function toggleMarkerTooltips(showTooltips) {
    		markers.forEach(({ marker }) => {
        		if (showTooltips) {
            			marker.openTooltip();
        		} else {
            			marker.closeTooltip();
       			 }
    		});
	}

	// Nasłuch na zmianę stanu checkboxa
	toggleMarkerTooltipsCheckbox.addEventListener('change', (e) => {
    		toggleMarkerTooltips(e.target.checked);
	});
        
        function transformCoordinates(lat, lng) {
    		const radians = lat * (Math.PI / 180); // Przelicz szerokość na radiany
    		const mercatorY = Math.log(Math.tan(Math.PI / 4 + radians / 2)); // Pseudomerkator
    		const normalizedY = (1 - (mercatorY / Math.PI)) / 2; // Normalizacja do [0, 1]

    		const visualX = ((lng + 256) / 512) * 6144; // Bez zmian
    		const visualY = normalizedY * 4096; // Dopasowanie do wysokości mapy

    		return { x: visualX.toFixed(0), y: visualY.toFixed(0) };
		}
        
        	const cursorCoordinates = document.getElementById('cursor-coordinates');

		const showRawCoordinatesCheckbox = document.getElementById('showRawCoordinates');

	map.on('mousemove', (e) => {
    		const lat = e.latlng.lat;
    		const lng = e.latlng.lng;

    		if (
        		lat >= imageBounds[0][0] && lat <= imageBounds[1][0] &&
        		lng >= imageBounds[0][1] && lng <= imageBounds[1][1]
    		) {
        		if (showRawCoordinatesCheckbox.checked) {
            			cursorCoordinates.textContent = `Współrzędne surowe: (${lat.toFixed(0)}, ${lng.toFixed(0)})`;
        		} else {
            			const transformed = transformCoordinates(lat, lng);
            			cursorCoordinates.textContent = `Współrzędne: (${transformed.x}, ${transformed.y})`;
        		}
    		} else {
        		cursorCoordinates.textContent = "Współrzędne: (0, 0)";
    		}
	});
    
		// Obsługa aktywacji odpowiedniego <select> na podstawie wyboru grupy
    document.getElementById('groupSelect').addEventListener('change', function () {
        const selectedGroup = this.value; // Pobierz wybraną wartość grupy
        
        // Ukryj wszystkie grupy markerów
        document.querySelectorAll('.marker-group').forEach(select => {
            select.style.display = 'none'; // Ukryj
            select.disabled = true; // Dezaktywuj
        });

        // Pokaż i aktywuj odpowiednią grupę
        const activeSelect = document.getElementById(`markerIcon${selectedGroup}`);
        if (activeSelect) {
            activeSelect.style.display = 'block'; // Pokaż aktywny
            activeSelect.disabled = false; // Aktywuj
        }
    });

        function inverseTransformCoordinates(x, y) {
    		const lng = (x / 6144) * 512 - 256;

    		// Normalizacja współrzędnej Y do zakresu pseudomerkatora
    		const normalizedY = 1 - (y / 4096);

    		// Odwrotność pseudomerkatora
    		const mercatorY = Math.PI * (2 * normalizedY - 1);
    		const lat = (2 * Math.atan(Math.exp(mercatorY)) - Math.PI / 2) * (180 / Math.PI); // Radians to degrees

    		return { lat: lat.toFixed(2), lng: lng.toFixed(2) };
		}

	map.on('mouseout', () => {
    		cursorCoordinates.textContent = "Współrzędne: (0, 0)";
	});
        
        document.getElementById('add-temp-marker').addEventListener('click', () => {
    		const x = parseFloat(document.getElementById('lng-input').value);
    		const y = parseFloat(document.getElementById('lat-input').value);

    		if (isNaN(x) || isNaN(y)) {
        		// alert('Proszę wprowadzić poprawne współrzędne.');
			// Pokaż komunikat w overlay
			showAlert('Proszę wprowadzić poprawne współrzędne.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		return;
    		}

    		const { lat, lng } = inverseTransformCoordinates(x, y);

    		if (
        		lat < imageBounds[0][0] || lat > imageBounds[1][0] ||
        		lng < imageBounds[0][1] || lng > imageBounds[1][1]
    		) {
        		// alert("Współrzędne znajdują się poza obszarem mapy.");
			// Pokaż komunikat w overlay
			showAlert('Współrzędne znajdują się poza obszarem mapy.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		return;
    		}

    		// Dodaj znacznik
    		const tempMarker = L.marker([lat, lng], {
        		icon: L.icon({
            		iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',
            		iconSize: [25, 41],
            		iconAnchor: [12, 41],
            		popupAnchor: [1, -34],
            		shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
            		shadowSize: [41, 41],
            		className: 'blinking-marker' // Klasa do migania
        		})
    		}).addTo(map);

    		// Przybliż mapę
    		map.setView([lat, lng], 4);

    		// Efekt migania
    		let blinkCount = 0;
    		const blinkInterval = setInterval(() => {
        		const markerElement = tempMarker._icon;
        		if (markerElement) {
            			markerElement.style.visibility = (markerElement.style.visibility === 'hidden') ? 'visible' : 'hidden';
        		}
        		blinkCount++;
        		if (blinkCount >= 10) { // 5 migań (widoczne/niewidoczne)
            			clearInterval(blinkInterval);
            			map.removeLayer(tempMarker); // Usuń znacznik
        		}
    		}, 500);
		});
        
        const menu = document.getElementById('menu');
	const toggleButton = document.getElementById('toggle-menu-button');
    	const zoomButton = document.querySelector('.leaflet-left');

	// Flaga określająca, czy menu jest widoczne
	let menuVisible = true;

	toggleButton.addEventListener('click', () => {
    		if (menuVisible) {
        		menu.style.transform = 'translateX(-100%)'; // Ukryj menu
        		toggleButton.style.left = '10px'; // Przesuń przycisk w lewo
        		zoomButton.style.left = '15px';
        		menuVisible = false;
    		} else {
        		menu.style.transform = 'translateX(0)'; // Pokaż menu
        		toggleButton.style.left = '291px'; // Przywróć pozycję przycisku
        		zoomButton.style.left = '281px'; // Przywróć pozycję przycisku
        		menuVisible = true;
    		}
	});

        map.on('click', (e) => {
		const lat = e.latlng.lat;
		const lng = e.latlng.lng;
		if (lat < imageBounds[0][0] || lat > imageBounds[1][0] || lng < imageBounds[0][1] || lng > imageBounds[1][1]) {
			// alert('Znacznik można dodać tylko w obszarze mapy.');
			// Pokaż komunikat w overlay
			showAlert('Znacznik można dodać tylko w obszarze mapy.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
			return;
		}
		openDialog(lat, lng);
        });

        addMarkerButton.addEventListener('click', addOrUpdateMarker);
        overlay.addEventListener('click', closeDialog);

        function updateMarkersWithTransformedCoordinates() {
    		markers.forEach(({ marker, title, lat, lon }) => {
        		// Transformacja współrzędnych
        		const { x, y } = transformCoordinates(lat, lon);

        		// Dodanie dymka
        		marker.unbindTooltip(); // Usuń poprzedni dymek, jeśli istnieje
        		marker.bindTooltip(`<strong>${title}</strong><br>Pozycja: [${x}, ${y}]`);
    		});
	}
        
        function addMarker(lat, lng, icon, title, iconType) {
    		// Transformacja współrzędnych
    		const { x, y } = transformCoordinates(lat, lng);

    		// Tworzenie znacznika
    		const marker = L.marker([lat, lng], { icon }).addTo(map);

    		// Dodanie dymka
    		marker.bindTooltip(`<strong>${title}</strong><br>Pozycja: [${x}, ${y}]`);

    		// Dodanie znacznika do tablicy
    		markers.push({ marker, title, iconType, lat, lon: lng });
	}
    
    
    

        const defaultMarkersData = [
    		{ lat: 63, lng: -71, icon: icons.miasto1, title: 'Bree', iconType: 'miasto' },
    		{ lat: 67, lng: -195, icon: icons.miasto2, title: 'Ered Luin', iconType: 'miasto' },
    		{ lat: 67, lng: 2, icon: icons.miasto4, title: 'Rivendell', iconType: 'miasto' },
            	{ lat: 20, lng: -41, icon: icons.miasto3, title: 'Tharbad', iconType: 'miasto' },
		{ lat: 61, lng: -98, icon: icons.miasto12, title: 'Hobbiton', iconType: 'miasto' },
		{ lat: 58, lng: -156, icon: icons.miasto14, title: 'Mithlond (Szare Przystanie)', iconType: 'miasto' },
		{ lat: 61, lng: -144, icon: icons.miasto9, title: 'Emyn Beraid (Białe Wieże)', iconType: 'miasto' },
		{ lat: 71, lng: -106, icon: icons.miasto7, title: 'Annúminas', iconType: 'miasto' },
		{ lat: 32, lng: 1, icon: icons.miasto15, title: 'Zachodnia brama Morii', iconType: 'miasto' },
		{ lat: -32, lng: -106, icon: icons.miasto13, title: 'Lond Daer', iconType: 'miasto' },
		{ lat: 83, lng: -117, icon: icons.miasto11, title: 'Osada w Forochel', iconType: 'miasto' },
		{ lat: 78, lng: -84, icon: icons.miasto10, title: 'Fornost', iconType: 'miasto' },
		{ lat: 81, lng: -36, icon: icons.miasto8, title: 'Carn Dûm', iconType: 'miasto' },
		{ lat: 66, lng: -38, icon: icons.miasto6, title: 'Amon Sûl', iconType: 'miasto' }
    		// Dodaj więcej markerów, jeśli potrzeba
	];
        
        let defaultMarkers = []; // Tablica przechowująca domyślne markery

		// Funkcja dodająca domyślne markery
		function addDefaultMarkers() {
    		defaultMarkers = defaultMarkersData.map(data => {
        		addMarker(data.lat, data.lng, data.icon, data.title, data.iconType);
        		return data; // Dodaj dane do tablicy defaultMarkers
    		});
		}

		// Funkcja usuwająca domyślne markery
		function removeDefaultMarkers() {
    		defaultMarkers.forEach(markerData => {
        		const markerToRemove = markers.find(m => 
            		m.lat === markerData.lat && 
            		m.lon === markerData.lng && 
            		m.title === markerData.title
        		);
        		if (markerToRemove) {
            		map.removeLayer(markerToRemove.marker); // Usuń marker z mapy
            		markers.splice(markers.indexOf(markerToRemove), 1); // Usuń z tablicy markers
        		}
    		});
    		defaultMarkers = []; // Wyczyść tablicę defaultMarkers
		}
        
        document.getElementById('toggleDefaultMarkersButton').addEventListener('change', (e) => {
    		if (e.target.checked) {
        		addDefaultMarkers(); // Dodaj domyślne markery
    		} else {
        		removeDefaultMarkers(); // Usuń domyślne markery
    		}
		});
        
        
//BACKEND     
        async function fetchWithAuth(url, options = {}) {
    		const token = localStorage.getItem('token'); // Pobierz token z localStorage
    		if (!options.headers) options.headers = {};
    		options.headers['Authorization'] = token ? `Bearer ${token}` : '';

    		try {
        		const response = await fetch(url, options);
        		if (response.status === 401) {
            			// alert('Nieautoryzowane! Proszę zalogować się ponownie.');
				// Pokaż komunikat w overlay
				showAlert('Nieautoryzowane! Proszę zalogować się ponownie.');

				// Ukryj komunikat po kilku sekundach
				setTimeout(() => {
					hideAlert();
				}, 3000); // Czas wyświetlania komunikatu w milisekundach
            			localStorage.removeItem('token');
        		}
        		return response.json();
    		} catch (error) {
        		console.error('Error fetching data:', error);
        		// alert('Wystąpił błąd podczas pobierania danych.');
			// Pokaż komunikat w overlay
			showAlert('Wystąpił błąd podczas pobierania danych.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
    		}
	}
        
        // Ukrywanie/wyświetlanie przycisków
	function toggleButtons() {
    		const token = localStorage.getItem('token');
    		if (!token) {
        		document.getElementById('logoutButton').style.display = 'none';
        		document.getElementById('loginForm').style.display = 'block'; // Zabezpiecz również przycisk logowania
        		document.getElementById('registerForm').style.display = 'block'; // I przycisk rejestracji
    		} else {
        		// document.getElementById('protectedDataButton').style.display = 'block';
        		document.getElementById('logoutButton').style.display = 'block';
        		document.getElementById('loginForm').style.display = 'none';
        		document.getElementById('registerForm').style.display = 'none';
    		}
	}

	// Event listener, który wywoła toggleButtons po załadowaniu strony
	document.addEventListener('DOMContentLoaded', async () => {
    		toggleButtons();  // Sprawdź, czy użytkownik jest zalogowany i ustaw przyciski
		const token = localStorage.getItem('token'); // Pobierz token z localStorage
    		if (token) {
        		await loadMarkers(); // 🟢 Wywołaj loadMarkers, aby pobrać znaczniki użytkownika

			// Sprawdź, czy toggle dla domyślnych markerów jest zaznaczony
        		const isDefaultMarkersVisible = document.getElementById('toggleDefaultMarkersButton').checked;

        		if (isDefaultMarkersVisible) {
            			addDefaultMarkers(); // Dodaj domyślne markery, jeśli toggle jest zaznaczony
        		}

			// Sprawdź, czy toggle dla dymków markerów jest zaznaczony
        		const isMarkerTooltipsVisible = document.getElementById('toggleMarkerTooltips').checked;

        		if (isMarkerTooltipsVisible) {
    				toggleMarkerTooltips(true); // Otwórz tooltipy, jeśli toggle jest zaznaczony
			} else {
    				toggleMarkerTooltips(false); // Zamknij tooltipy, jeśli toggle nie jest zaznaczony
			}
    		}
        	// addDefaultMarkers(); // Dodaj przykładowe znaczniki, które będą widoczne dla każdego użytkownika
	});

	// Ogólne funkcje pomocnicze
	function showLoading(message = 'Ładowanie...') {
    	document.getElementById('loadingIndicator').innerText = message;
    	document.getElementById('loadingOverlay').style.display = 'block';
	}

	function hideLoading() {
    	document.getElementById('loadingIndicator').innerText = 'Ładowanie...';
    	document.getElementById('loadingOverlay').style.display = 'none';
	}

	function showAlert(message = 'Alert...') {
    	document.getElementById('alertIndicator').innerText = message;
    	document.getElementById('alertOverlay').style.display = 'block';
	}

	function hideAlert() {
    	document.getElementById('alertIndicator').innerText = 'Alert...';
    	document.getElementById('alertOverlay').style.display = 'none';
	}
        
        // Obsługa formularza rejestracji
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
    		e.preventDefault();

    		// Pobranie danych wejściowych
    		const username = e.target.username.value.trim();
    		const password = e.target.password.value.trim();

    		// Walidacja danych wejściowych
    		if (!username || !password) {
        		// alert('Nazwa użytkownika i hasło nie mogą być puste.');
			// Pokaż komunikat w overlay
			showAlert('Nazwa użytkownika i hasło nie mogą być puste.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		return;
    		}

    		if (password.length < 6) {
        		// alert('Hasło musi mieć co najmniej 6 znaków.');
			// Pokaż komunikat w overlay
			showAlert('Hasło musi mieć co najmniej 6 znaków.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		return;
    		}

    		showLoading('Uruchamianie aplikacji, proszę czekać...');

    		try {
        		const response = await fetch('https://endore-map.onrender.com/auth/register', {
            		method: 'POST',
            		headers: { 'Content-Type': 'application/json' },
            		body: JSON.stringify({ username, password }),
        		});

        		const data = await response.json();

        		if (response.ok && data.message === 'User registered') {
            			// alert('Rejestracja udana! Teraz możesz się zalogować.');
				// Pokaż komunikat w overlay
				showAlert('Rejestracja udana! Teraz możesz się zalogować.');

				// Ukryj komunikat po kilku sekundach
				setTimeout(() => {
					hideAlert();
				}, 3000); // Czas wyświetlania komunikatu w milisekundach
            			toggleButtons(); // Aktualizacja widoczności przycisków
            			document.getElementById('registerForm').reset(); // Wyczyść formularz
        		} else if (data.message === 'User already exists') {
            			// alert('Nazwa użytkownika jest już zajęta. Wybierz inną.');
				// Pokaż komunikat w overlay
				showAlert('Nazwa użytkownika jest już zajęta. Wybierz inną.');

				// Ukryj komunikat po kilku sekundach
				setTimeout(() => {
					hideAlert();
				}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		} else {
            			// alert(`Rejestracja nie powiodła się: ${data.message || 'Unknown error'}`);
				// Pokaż komunikat w overlay
				showAlert(`Rejestracja nie powiodła się: ${data.message || 'Unknown error'}`);

				// Ukryj komunikat po kilku sekundach
				setTimeout(() => {
					hideAlert();
				}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		}
    		} catch (error) {
        		console.error('Błąd podczas rejestracji:', error);
        		// alert('Wystąpił błąd podczas rejestracji. Spróbuj ponownie.');
			// Pokaż komunikat w overlay
			showAlert('Wystąpił błąd podczas rejestracji. Spróbuj ponownie.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
    		} finally {
        		hideLoading();
    		}
	});

        
        // Obsługa formularza logowania
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
    		e.preventDefault();
		
    		const username = e.target.username.value;
    		const password = e.target.password.value;

		// Walidacja danych wejściowych
    		if (!username || !password) {
        		// alert('Nazwa użytkownika i hasło nie mogą być puste.');
			// Pokaż komunikat w overlay
			showAlert('Nazwa użytkownika i hasło nie mogą być puste.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
        		return;
    		}

		showLoading('Uruchamianie aplikacji, proszę czekać...');

    		try {
			const response = await fetch('https://endore-map.onrender.com/auth/login', {
        			method: 'POST',
        			headers: { 'Content-Type': 'application/json' },
        			body: JSON.stringify({ username, password }),
    			});

			if (!response.ok) {
            			// Obsługa odpowiedzi błędnych
            			const errorData = await response.json();
            			if (response.status === 401) {
                			// alert('Nieprawidłowa nazwa użytkownika lub hasło. Spróbuj ponownie.');
					// Pokaż komunikat w overlay
					showAlert('Nieprawidłowa nazwa użytkownika lub hasło. Spróbuj ponownie.');

					// Ukryj komunikat po kilku sekundach
					setTimeout(() => {
						hideAlert();
					}, 3000); // Czas wyświetlania komunikatu w milisekundach
            			} else if (response.status === 404) {
                			// alert('Użytkownik nie znaleziony. Proszę się zarejestrować lub sprawdzić nazwę użytkownika.');
					// Pokaż komunikat w overlay
					showAlert('Użytkownik nie znaleziony. Proszę się zarejestrować lub sprawdzić nazwę użytkownika.');

					// Ukryj komunikat po kilku sekundach
					setTimeout(() => {
						hideAlert();
					}, 3000); // Czas wyświetlania komunikatu w milisekundach
            			} else {
                			// alert(`Logowanie nie powiodło się: ${errorData.message || 'Unknown error'}`);
					// Pokaż komunikat w overlay
					showAlert(`Logowanie nie powiodło się: ${errorData.message || 'Unknown error'}`);

					// Ukryj komunikat po kilku sekundach
					setTimeout(() => {
						hideAlert();
					}, 3000); // Czas wyświetlania komunikatu w milisekundach
            			}
            			return;
        		}

    			const data = await response.json();
			
    			if (data.token) {
        			localStorage.setItem('token', data.token); // Zapis tokena
				console.log("Token saved:", data.token);
        			// alert('Zalogowano pomyślnie!');\
				// Pokaż komunikat w overlay
				showAlert('Zalogowano pomyślnie!');

				// Ukryj komunikat po kilku sekundach
				setTimeout(() => {
					hideAlert();
				}, 3000); // Czas wyświetlania komunikatu w milisekundach
				toggleButtons();  // Zaktualizuj widoczność przycisków po zalogowaniu
				document.getElementById('loginForm').reset(); // Wyczyść formularz po logowaniu
				await loadMarkers(); // 🟢 Wywołaj funkcję loadMarkers po zalogowaniu
				addDefaultMarkers(); // 🟢 Wywołaj funkcję addDefaultMarkers po zalogowaniu
    			}
		} catch (error) {
			console.error('Error during login:', error);
			// alert('Wystąpił błąd podczas logowania. Spróbuj ponownie.');
			// Pokaż komunikat w overlay
			showAlert('Wystąpił błąd podczas logowania. Spróbuj ponownie.');

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
		} finally {
			hideLoading();
		}
	});
        
        // Obsługa wylogowania
        document.getElementById('logoutButton').addEventListener('click', () => {
    		// Usuń token z localStorage
    		localStorage.removeItem('token');
		// Usuń wszystkie znaczniki użytkownika z mapy
    		markers.forEach(({ marker }) => map.removeLayer(marker));
    		// Wyczyść tablicę przechowującą znaczniki użytkownika
    		markers.length = 0;
    		// alert('Wylogowano pomyślnie!');
		// Pokaż komunikat w overlay
		showAlert('Wylogowano pomyślnie!');

		// Ukryj komunikat po kilku sekundach
		setTimeout(() => {
			hideAlert();
		}, 3000); // Czas wyświetlania komunikatu w milisekundach
		toggleButtons();  // Zaktualizuj widoczność przycisków po wylogowaniu
		// Opcjonalnie wyczyść formularze
    		document.getElementById('loginForm').reset(); // Wyczyść formularz logowania
    		document.getElementById('registerForm').reset(); // Wyczyść formularz rejestracji
		// Dodaj przykładowe znaczniki z powrotem
    		// addDefaultMarkers();  // Ponownie dodaj przykładowe znaczniki
	});
    
    // Funkcja do obsługi widoczności hasła
	function setupPasswordToggle(passwordFieldId, toggleButtonId, eyeIconId) {
    	const passwordField = document.getElementById(passwordFieldId);
    	const toggleButton = document.getElementById(toggleButtonId);
    	const eyeIcon = document.getElementById(eyeIconId);

    	toggleButton.addEventListener('click', function () {
        	if (passwordField.type === 'password') {
            	passwordField.type = 'text'; // Ustaw widoczność hasła
            	eyeIcon.classList.remove('fa-eye-slash');
            	eyeIcon.classList.add('fa-eye'); // Zmień ikonę
        	} else {
            	passwordField.type = 'password'; // Ukryj hasło
            	eyeIcon.classList.remove('fa-eye');
            	eyeIcon.classList.add('fa-eye-slash'); // Zmień ikonę
        	}
    	});
	}

	// Zastosowanie funkcji dla rejestracji
	setupPasswordToggle('passwordFieldRegister', 'togglePasswordVisibilityRegister', 'eyeIconRegister');

	// Zastosowanie funkcji dla logowania
	setupPasswordToggle('passwordFieldLogin', 'togglePasswordVisibilityLogin', 'eyeIconLogin');

	// GET /markers: Pobierz znaczniki dla zalogowanego użytkownika.
	async function loadMarkers() {
		showLoading('Ładowanie znaczników, proszę czekać...');
    		try {
        		// Pobierz token z localStorage
        		const token = localStorage.getItem('token');
        
        		// Upewnij się, że token istnieje
        		if (!token) {
            			throw new Error('Brak tokena uwierzytelniającego');
        		}

        		// Wykonaj żądanie GET do endpointa /markers
        		const response = await fetch('https://endore-map.onrender.com/markers', {
            			method: 'GET',
            			headers: { 
                			'Authorization': `Bearer ${token}` 
            			}
        		});

        		// Obsługa błędu, jeśli odpowiedź nie jest OK
        		if (!response.ok) {
            			const errorMessage = await response.text();
    				throw new Error(`Błąd podczas pobierania znaczników: ${response.status} - ${errorMessage}`);
        		}

        		// Przetwórz odpowiedź na JSON
        		const markersData = await response.json();
			if (!Array.isArray(markersData)) {
    				throw new Error('Niepoprawna odpowiedź API - oczekiwano tablicy znaczników');
			}

        		// Usuń wszystkie istniejące znaczniki z mapy
        		markers.forEach(({ marker }) => map.removeLayer(marker));
        		markers.length = 0; // Wyczyść tablicę znaczników

        		// Iteracja przez pobrane znaczniki i dodanie ich do mapy
        		markersData.forEach(markerData => {
            			const { title, iconType, coordinates } = markerData;
            			const icon = icons[iconType] || icons.default; // Użyj ikony na podstawie typu lub domyślnej
            			const mapMarker = L.marker([coordinates.lat, coordinates.lng], { icon }).addTo(map);

            			// Dodanie dymka (tooltipa) do znacznika
            			mapMarker.bindTooltip(`<strong>${title}</strong>`);

            			// Dodaj obsługę kliknięcia w znacznik, aby otworzyć okno edycji
            			mapMarker.on('click', () => openDialog(coordinates.lat, coordinates.lng, markerData));

            			// Dodaj znacznik do lokalnej tablicy znaczników
            			markers.push({ marker: mapMarker, ...markerData });
        		});

        		console.log('Znaczniki zostały pomyślnie załadowane');
    		} catch (error) {
        		console.error('Błąd podczas ładowania znaczników:', error);
        		// alert('Nie udało się pobrać znaczników: ' + error.message);
			// Pokaż komunikat w overlay
			showAlert('Nie udało się pobrać znaczników: ' + error.message);

			// Ukryj komunikat po kilku sekundach
			setTimeout(() => {
				hideAlert();
			}, 3000); // Czas wyświetlania komunikatu w milisekundach
    		} finally {
			hideLoading();
		}
	}

	// POST /markers: Funkcja do dodawania nowego znacznika na serwerze
	async function addMarkerToServer(markerData) {
    try {
        const token = localStorage.getItem('token');
        if (!token) {
            throw new Error('Brak tokena uwierzytelniającego');
        }

        const response = await fetch('https://endore-map.onrender.com/markers', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(markerData)
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Błąd podczas dodawania znacznika: ${response.status} - ${errorData.message || errorData}`);
        }

        const newMarker = await response.json();
        return newMarker;
    } catch (error) {
        console.error('Błąd podczas dodawania znacznika na serwerze:', error);
        // alert('Nie udało się dodać znacznika: ' + error.message);
	// Pokaż komunikat w overlay
	showAlert('Nie udało się dodać znacznika: ' + error.message);

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
        throw error;
    }
}


	// PUT /markers:id Funkcja do aktualizacji istniejącego znacznika na serwerze
	async function updateMarkerOnServer(markerId, markerData) {
    try {
        const token = localStorage.getItem('token');
        if (!token) {
            throw new Error('Brak tokena uwierzytelniającego');
        }

        const response = await fetch(`https://endore-map.onrender.com/markers/${markerId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(markerData)
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Błąd podczas aktualizacji znacznika: ${response.status} - ${errorData.message || errorData}`);
        }

        const updatedMarker = await response.json();
        return updatedMarker;
    } catch (error) {
        console.error('Błąd podczas aktualizacji znacznika na serwerze:', error);
        // alert('Nie udało się zaktualizować znacznika: ' + error.message);
	// Pokaż komunikat w overlay
	showAlert('Nie udało się zaktualizować znacznika: ' + error.message);

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
        throw error;
    }
}

	// DELETE /markers:id Funkcja do usuwania istniejącego znacznika na serwerze
	async function deleteMarkerFromServer(markerId) {
    try {
        const token = localStorage.getItem('token');
        if (!token) {
            throw new Error('Brak tokena uwierzytelniającego');
        }

        const response = await fetch(`https://endore-map.onrender.com/markers/${markerId}`, {
            method: 'DELETE',
            headers: {
                'Authorization': `Bearer ${token}`
            }
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Błąd podczas usuwania znacznika: ${response.status} - ${errorData.message || errorData}`);
        }

        console.log(`Znacznik o ID ${markerId} został usunięty`);
        // alert('Znacznik został pomyślnie usunięty.');
	// Pokaż komunikat w overlay
	showAlert('Znacznik został pomyślnie usunięty.');

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach	
    } catch (error) {
        console.error('Błąd podczas usuwania znacznika:', error);
        // alert('Nie udało się usunąć znacznika: ' + error.message);
	// Pokaż komunikat w overlay
	showAlert('Nie udało się usunąć znacznika: ' + error.message);

	// Ukryj komunikat po kilku sekundach
	setTimeout(() => {
		hideAlert();
	}, 3000); // Czas wyświetlania komunikatu w milisekundach
    }
}

    </script>
</body>
</html>
